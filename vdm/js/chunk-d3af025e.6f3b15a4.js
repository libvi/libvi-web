(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d3af025e"],{"6dab":function(e,t,n){},"9dc0":function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"preview-vditor",attrs:{"element-loading-text":"正在努力，请稍候..."}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"vditor-preview",attrs:{id:"khaleesi"}})])},r=[],a=n("e6bc"),o=n.n(a),s={name:"PreviewVditor",data:function(){return{isLoading:!0}},props:{pdata:{type:String,required:!0,default:""}},created:function(){this.$utils.updateHtmlStyle(),this.setDefaultText()},components:{},mounted:function(){this.initVditor(),this.$utils.hideVditorTextarea()},methods:{initVditor:function(){var e=this,t={width:"61.8%",mode:"sv",preview:{delay:1e3,show:!0}};this.vditor=new o.a("khaleesi",t),this.$nextTick((function(){e.isLoading=!1}))},setDefaultText:function(){localStorage.setItem("vditorkhaleesi",this.pdata)}}},c=s,d=(n("ad6f"),n("0c7c")),u=Object(d["a"])(c,i,r,!1,null,null,null);t["a"]=u.exports},ad6f:function(e,t,n){"use strict";n("6dab")},e103:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"export-page"},[t("div",{staticClass:"button-group"},[t("el-button",{attrs:{round:""},on:{click:e.onBackToMainPage}},[e._v("返回主页")]),t("el-button",{attrs:{round:"",type:"primary",loading:e.isExporting},on:{click:e.onExportBtnClick}},[e._v("\n      "+e._s(e.isExporting?"正在导出...":"生成导出")+"\n    ")])],1),t("PreviewVditor",{attrs:{pdata:e.pdata}})],1)},r=[],a=(n("96cf"),n("1da1")),o=(n("a481"),n("c0e9")),s=n.n(o),c=n("0132"),d=n.n(c),u=960,l=800,h=50,p=80,g=6,v=0,m=40,f=50,w="rgba(0, 0, 0, 0.21)";function x(e,t){var n=document.createElement("canvas");n.width=u*t,n.height=l*t;var i=n.getContext("2d"),r=g*t,a=r,o=0,s=a+n.width-2*r,c=o,d=s+r,h=r,p=d,v=h+n.height-2*r,m=s,f=v+r,w=a,x=f,C=w-r,T=v,k=C,b=h;return i.beginPath(),i.moveTo(a,o),i.lineTo(s,c),i.quadraticCurveTo(d,c,d,h),i.lineTo(p,v),i.quadraticCurveTo(p,f,m,f),i.lineTo(w,x),i.quadraticCurveTo(C,x,C,T),i.lineTo(k,b),i.quadraticCurveTo(k,o,a,o),i.clip(),i.drawImage(e,0,0),n}function C(e){var t=document.createElement("canvas");t.width=e.width+h,t.height=e.height+p;var n=t.getContext("2d");return n.shadowOffsetX=v,n.shadowOffsetY=m,n.shadowBlur=f,n.shadowColor=w,n.drawImage(e,h/2,0),t}var T=function(e){for(var t=[],n=[],i=e.querySelectorAll("svg"),r=0,a=i.length;r<a;r++){var o=i[r],s=o.parentNode;try{var c=(new XMLSerializer).serializeToString(o),u=document.createElement("canvas"),l=o.getBoundingClientRect();u.width=l.width,u.height=l.height;u.getContext("2d");d()(u,c,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!1,ignoreClear:!0}),t.push({parent:s,child:o}),s.removeChild(o),n.push({parent:s,child:u}),s.appendChild(u)}catch(h){console.error("处理SVG时出错:",h)}}return{nodesToRecover:t,nodesToRemove:n}},k=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return T(t),n=getComputedStyle(t),u=+n.width.replace("px",""),l=+n.height.replace("px",""),i=window.devicePixelRatio,r={scale:i,allowTaint:!0,useCORS:!0,backgroundColor:"#fefefe",imageTimeout:0,logging:!1},e.next=1,s()(t,r);case 1:return a=e.sent,o=x(a,i),e.abrupt("return",C(o));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=n("9dc0"),E={name:"export-image",data:function(){return{isLoading:!0,isExporting:!1,pdata:localStorage.getItem("vditorvditor")}},created:function(){},components:{PreviewVditor:b["a"]},mounted:function(){},updated:function(){},methods:{exportAndDownloadImg:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var i,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,k(t);case 1:i=e.sent,r="download"in document.createElement("a"),r&&(a=document.createElement("a"),a.download=n,a.href=i.toDataURL("image/png"),a.click()),e.next=3;break;case 2:e.prev=2,o=e["catch"](0),console.error("导出图片失败:",o),this.$message.closeAll(),this.$message.error("导出图片失败，请检查控制台获取详细错误信息");case 3:return e.prev=3,this.isLoading=!1,this.isExporting=!1,e.finish(3);case 4:case"end":return e.stop()}}),e,this,[[0,2,3,4]])})));function t(t,n){return e.apply(this,arguments)}return t}(),onBackToMainPage:function(){this.$router.push("/")},onExportBtnClick:function(){this.isLoading=!0,this.isExporting=!0;var e=document.querySelector("#khaleesi .vditor-preview"),t=this.$utils.getExportFileName();this.exportAndDownloadImg(e,t)}}},y=E,L=n("0c7c"),S=Object(L["a"])(y,i,r,!1,null,null,null);t["default"]=S.exports}}]);